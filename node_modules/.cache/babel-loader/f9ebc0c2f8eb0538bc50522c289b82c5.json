{"ast":null,"code":"import _regeneratorRuntime from\"/Users/allisonwang/Downloads/chem-final/OATutor-Chem1A/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toArray from\"/Users/allisonwang/Downloads/chem-final/OATutor-Chem1A/node_modules/@babel/runtime/helpers/esm/toArray.js\";import _slicedToArray from\"/Users/allisonwang/Downloads/chem-final/OATutor-Chem1A/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/Users/allisonwang/Downloads/chem-final/OATutor-Chem1A/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _createForOfIteratorHelper from\"/Users/allisonwang/Downloads/chem-final/OATutor-Chem1A/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _classCallCheck from\"/Users/allisonwang/Downloads/chem-final/OATutor-Chem1A/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/allisonwang/Downloads/chem-final/OATutor-Chem1A/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"/Users/allisonwang/Downloads/chem-final/OATutor-Chem1A/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/Users/allisonwang/Downloads/chem-final/OATutor-Chem1A/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/allisonwang/Downloads/chem-final/OATutor-Chem1A/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from\"react\";import{AppBar,Toolbar}from\"@material-ui/core\";import Grid from\"@material-ui/core/Grid\";import ProblemWrapper from\"@components/problem-layout/ProblemWrapper.js\";import LessonSelectionWrapper from\"@components/problem-layout/LessonSelectionWrapper.js\";import{withRouter}from\"react-router-dom\";import LinearProgress from'@material-ui/core/LinearProgress';import{coursePlans,findLessonById,LESSON_PROGRESS_STORAGE_KEY,MIDDLEWARE_URL,SITE_NAME,ThemeContext,CANVAS_WARNING_STORAGE_KEY,SHOW_NOT_CANVAS_WARNING,MASTERY_THRESHOLD}from\"../config/config.js\";import to from\"await-to-js\";import{toast}from\"react-toastify\";import ToastID from\"../util/toastIds\";import BrandLogoNav from\"@components/BrandLogoNav\";import{cleanArray}from\"../util/cleanObject\";import ErrorBoundary from\"@components/ErrorBoundary\";import{CONTENT_SOURCE}from\"@common/global-config\";import withTranslation from'../util/withTranslation';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var problemPool=require(\"@generated/processed-content-pool/\".concat(CONTENT_SOURCE,\".json\"));var seed=Date.now().toString();console.log(\"Generated seed\");var Platform=/*#__PURE__*/function(_React$Component){_inherits(Platform,_React$Component);var _super=_createSuper(Platform);function Platform(props,_context){var _this;_classCallCheck(this,Platform);_this=_super.call(this,props);_this.selectCourse=function(course,context){_this.course=course;_this.setState({status:\"lessonSelection\"});};_this._nextProblem=function(context){seed=Date.now().toString();_this.setState({seed:seed});_this.props.saveProgress();if(_this.lesson.topics==\"Atom, Conversion, Stoichiometry (Module A)\"&&!_this.completedProbs.has(\"a041b61EmailAddress\")){var preambleProblem=_this.problemIndex.problems.find(function(p){return p.id===\"a041b61EmailAddress\";});if(preambleProblem){_this.setState({currProblem:preambleProblem,status:\"learning\"});return preambleProblem;}}var problems=_this.problemIndex.problems.filter(function(_ref){var courseName=_ref.courseName;return!courseName.toString().startsWith(\"!!\");});var chosenProblem;console.debug(\"Platform.js: sample of available problems\",problems.slice(0,10));var _iterator=_createForOfIteratorHelper(problems),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var problem=_step.value;// Calculate the mastery for this problem\nvar probMastery=1;var isRelevant=false;var _iterator2=_createForOfIteratorHelper(problem.steps),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var step=_step2.value;if(typeof step.knowledgeComponents===\"undefined\"){continue;}var _iterator3=_createForOfIteratorHelper(step.knowledgeComponents),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var kc=_step3.value;if(typeof context.bktParams[kc]===\"undefined\"){console.log(\"BKT Parameter \"+kc+\" does not exist.\");continue;}if(kc in _this.lesson.learningObjectives){isRelevant=true;}// Multiply all the mastery priors\nif(!(kc in context.bktParams)){console.log(\"Missing BKT parameter: \"+kc);}probMastery*=context.bktParams[kc].probMastery;}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}if(isRelevant){problem.probMastery=probMastery;}else{problem.probMastery=null;}}}catch(err){_iterator.e(err);}finally{_iterator.f();}console.debug(\"Platform.js: available problems \".concat(problems.length,\", completed problems \").concat(_this.completedProbs.size));chosenProblem=context.heuristic(problems,_this.completedProbs);console.debug(\"Platform.js: chosen problem\",chosenProblem);var objectives=Object.keys(_this.lesson.learningObjectives);console.debug(\"Platform.js: objectives\",objectives);var score=objectives.reduce(function(x,y){return x+context.bktParams[y].probMastery;},0);score/=objectives.length;_this.displayMastery(score);//console.log(Object.keys(context.bktParams).map((skill) => (context.bktParams[skill].probMastery <= this.lesson.learningObjectives[skill])));\n// There exists a skill that has not yet been mastered (a True)\n// Note (number <= null) returns false\nif(!Object.keys(context.bktParams).some(function(skill){return context.bktParams[skill].probMastery<=MASTERY_THRESHOLD;})){_this.setState({status:\"graduated\"});console.log(\"Graduated\");return null;}else if(chosenProblem==null){console.debug(\"no problems were chosen\");// We have finished all the problems\nif(_this.lesson&&!_this.lesson.allowRecycle){// If we do not allow problem recycle then we have exhausted the pool\n_this.setState({status:\"exhausted\"});return null;}else{_this.completedProbs=new Set();chosenProblem=context.heuristic(problems,_this.completedProbs);}}if(chosenProblem){_this.setState({currProblem:chosenProblem,status:\"learning\"});// console.log(\"Next problem: \", chosenProblem.id);\nconsole.debug(\"problem information\",chosenProblem);_this.context.firebase.startedProblem(chosenProblem.id,chosenProblem.courseName,chosenProblem.lesson,_this.lesson.learningObjectives);return chosenProblem;}else{console.debug(\"still no chosen problem..? must be an error\");}};_this.updateCanvas=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(mastery,components){var _this$context,err,response,_yield$to,_yield$to2,responseText,_responseText$split,_responseText$split2,message,addInfo,_this$context$browser,getByKey,setByKey,showWarning;return _regeneratorRuntime().wrap(function _callee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!_this.context.jwt){_context2.next=42;break;}console.debug(\"updating canvas with problem score\");_context2.next=4;return to(fetch(\"\".concat(MIDDLEWARE_URL,\"/postScore\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({token:((_this$context=_this.context)===null||_this$context===void 0?void 0:_this$context.jwt)||\"\",mastery:mastery,components:components})}));case 4:_yield$to=_context2.sent;_yield$to2=_slicedToArray(_yield$to,2);err=_yield$to2[0];response=_yield$to2[1];if(!(err||!response)){_context2.next=13;break;}toast.error(\"An unknown error occurred trying to submit this problem. If reloading does not work, please contact us.\",{toastId:ToastID.submit_grade_unknown_error.toString()});console.debug(err,response);_context2.next=40;break;case 13:if(!(response.status!==200)){_context2.next=39;break;}_context2.t0=response.status;_context2.next=_context2.t0===400?17:_context2.t0===401?31:_context2.t0===403?33:35;break;case 17:_context2.next=19;return response.text();case 19:responseText=_context2.sent;_responseText$split=responseText.split(\"|\"),_responseText$split2=_toArray(_responseText$split),message=_responseText$split2[0],addInfo=_responseText$split2.slice(1);if(Array.isArray(addInfo)&&addInfo.length>0&&addInfo[0]){addInfo=JSON.parse(addInfo[0]);}_context2.t1=message;_context2.next=_context2.t1===\"lost_link_to_lms\"?25:_context2.t1===\"unable_to_handle_score\"?27:29;break;case 25:toast.error(\"It seems like the link back to your LMS has been lost. Please re-open the assignment to make sure your score is saved.\",{toastId:ToastID.submit_grade_link_lost.toString()});return _context2.abrupt(\"return\");case 27:toast.warn(\"Something went wrong and we can't update your score right now. Your progress will be saved locally so you may continue working.\",{toastId:ToastID.submit_grade_unable.toString(),closeOnClick:true});return _context2.abrupt(\"return\");case 29:toast.error(\"Error: \".concat(responseText),{closeOnClick:true});return _context2.abrupt(\"return\");case 31:toast.error(\"Your session has either expired or been invalidated, please reload the page to try again.\",{toastId:ToastID.expired_session.toString()});return _context2.abrupt(\"return\");case 33:toast.error(\"You are not authorized to make this action. (Are you a registered student?)\",{toastId:ToastID.not_authorized.toString()});return _context2.abrupt(\"return\");case 35:toast.error(\"An unknown error occurred trying to submit this problem. If reloading does not work, please contact us.\",{toastId:ToastID.set_lesson_unknown_error.toString()});return _context2.abrupt(\"return\");case 37:_context2.next=40;break;case 39:console.debug(\"successfully submitted grade to Canvas\");case 40:_context2.next=50;break;case 42:_this$context$browser=_this.context.browserStorage,getByKey=_this$context$browser.getByKey,setByKey=_this$context$browser.setByKey;_context2.next=45;return getByKey(CANVAS_WARNING_STORAGE_KEY);case 45:_context2.t2=!_context2.sent;if(!_context2.t2){_context2.next=48;break;}_context2.t2=SHOW_NOT_CANVAS_WARNING;case 48:showWarning=_context2.t2;if(showWarning){toast.warn(\"No credentials found (did you launch this assignment from Canvas?)\",{toastId:ToastID.warn_not_from_canvas.toString(),autoClose:false,onClick:function onClick(){toast.dismiss(ToastID.warn_not_from_canvas.toString());},onClose:function onClose(){setByKey(CANVAS_WARNING_STORAGE_KEY,1);}});}else{// can ignore\n}case 50:case\"end\":return _context2.stop();}}},_callee);}));return function(_x,_x2){return _ref2.apply(this,arguments);};}();_this.problemComplete=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(context){var setByKey,relevantKc,progressData,progressPercent,allProblemsCompleted;return _regeneratorRuntime().wrap(function _callee2$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this.completedProbs.add(_this.state.currProblem.id);setByKey=_this.context.browserStorage.setByKey;_context3.next=4;return setByKey(LESSON_PROGRESS_STORAGE_KEY(_this.lesson.id),_this.completedProbs).catch(function(error){_this.context.firebase.submitSiteLog(\"site-error\",\"componentName: Platform.js\",{errorName:error.name||\"n/a\",errorCode:error.code||\"n/a\",errorMsg:error.message||\"n/a\",errorStack:error.stack||\"n/a\"},_this.state.currProblem.id);});case 4:relevantKc={};Object.keys(_this.lesson.learningObjectives).forEach(function(x){var _context$bktParams$x$,_context$bktParams$x;relevantKc[x]=(_context$bktParams$x$=(_context$bktParams$x=context.bktParams[x])===null||_context$bktParams$x===void 0?void 0:_context$bktParams$x.probMastery)!==null&&_context$bktParams$x$!==void 0?_context$bktParams$x$:0;});// Check if all problems are completed or all skills are mastered\nprogressData=_this.getProgressBarData();progressPercent=progressData.percent/100;allProblemsCompleted=progressData.completed===progressData.total;if(allProblemsCompleted){console.debug(\"updateCanvas called because lesson is complete\");_this.updateCanvas(progressPercent,relevantKc);}_this._nextProblem(context);case 11:case\"end\":return _context3.stop();}}},_callee2);}));return function(_x3){return _ref3.apply(this,arguments);};}();_this.displayMastery=function(mastery){_this.setState({mastery:mastery});if(mastery>=MASTERY_THRESHOLD){toast.success(\"You've successfully completed this assignment!\",{toastId:ToastID.successfully_completed_lesson.toString()});}};_this.problemIndex={problems:problemPool};_this.completedProbs=new Set();_this.lesson=null;_this.user=_context.user||{};console.debug(\"USER: \",_this.user);_this.isPrivileged=!!_this.user.privileged;_this.context=_context;// Add each Q Matrix skill model attribute to each step\nvar _iterator4=_createForOfIteratorHelper(_this.problemIndex.problems),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var problem=_step4.value;for(var stepIndex=0;stepIndex<problem.steps.length;stepIndex++){var step=problem.steps[stepIndex];step.knowledgeComponents=cleanArray(_context.skillModel[step.id]||[]);}}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}if(_this.props.lessonID==null){_this.state={currProblem:null,status:\"courseSelection\",seed:seed};}else{_this.state={currProblem:null,status:\"courseSelection\",seed:seed};}_this.selectLesson=_this.selectLesson.bind(_assertThisInitialized(_this));return _this;}_createClass(Platform,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this._isMounted=true;if(this.props.lessonID!=null){console.log(\"calling selectLesson from componentDidMount...\");var lesson=findLessonById(this.props.lessonID);console.debug(\"lesson: \",lesson);this.selectLesson(lesson).then(function(_){console.debug(\"loaded lesson \"+_this2.props.lessonID,_this2.lesson);});var setLanguage=this.props.setLanguage;if(lesson.courseName=='Matematik 4'){setLanguage('se');}else{var defaultLocale=localStorage.getItem('defaultLocale');setLanguage(defaultLocale);}}else if(this.props.courseNum!=null){this.selectCourse(coursePlans[parseInt(this.props.courseNum)]);}this.onComponentUpdate(null,null,null);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this._isMounted=false;this.context.problemID=\"n/a\";}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState,snapshot){this.onComponentUpdate(prevProps,prevState,snapshot);}},{key:\"onComponentUpdate\",value:function onComponentUpdate(prevProps,prevState,snapshot){var _this$state$currProbl;if(Boolean((_this$state$currProbl=this.state.currProblem)===null||_this$state$currProbl===void 0?void 0:_this$state$currProbl.id)&&this.context.problemID!==this.state.currProblem.id){this.context.problemID=this.state.currProblem.id;}if(this.state.status!==\"learning\"){this.context.problemID=\"n/a\";}}},{key:\"getProgressBarData\",value:function getProgressBarData(){if(!this.lesson)return{completed:0,total:0,percent:0};var lessonName=String(this.lesson.name.replace(\"Lesson \",\"\")+\" \"+this.lesson.topics);var problems=this.problemIndex.problems.filter(function(_ref4){var lesson=_ref4.lesson;return String(lesson).includes(lessonName);});var completed=this.completedProbs.size;var total=problems.length;var percent=total>0?Math.round(completed/total*100):0;return{completed:completed,total:total,percent:percent};}},{key:\"selectLesson\",value:function(){var _selectLesson=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(lesson){var _this3=this;var updateServer,context,_this$context2,err,response,_yield$to3,_yield$to4,responseText,_responseText$split3,_responseText$split4,message,addInfo,_responseText,_responseText$split5,_responseText$split6,_message,_addInfo,loadLessonProgress,_yield$Promise$all,_yield$Promise$all2,prevCompletedProbs,_args4=arguments;return _regeneratorRuntime().wrap(function _callee4$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:updateServer=_args4.length>1&&_args4[1]!==undefined?_args4[1]:true;context=this.context;console.debug(\"lesson: \",context);console.debug(\"update server: \",updateServer);console.debug(\"context: \",context);if(this._isMounted){_context5.next=8;break;}console.debug(\"component not mounted, returning early (1)\");return _context5.abrupt(\"return\");case 8:if(!this.isPrivileged){_context5.next=53;break;}// from canvas or other LTI Consumers\nconsole.log(\"valid privilege\");_context5.next=12;return to(fetch(\"\".concat(MIDDLEWARE_URL,\"/setLesson\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({token:(context===null||context===void 0?void 0:context.jwt)||((_this$context2=this.context)===null||_this$context2===void 0?void 0:_this$context2.jwt)||\"\",lesson:lesson})}));case 12:_yield$to3=_context5.sent;_yield$to4=_slicedToArray(_yield$to3,2);err=_yield$to4[0];response=_yield$to4[1];if(!(err||!response)){_context5.next=22;break;}toast.error(\"Error setting lesson for assignment \\\"\".concat(this.user.resource_link_title,\"\\\"\"));console.debug(err,response);return _context5.abrupt(\"return\");case 22:if(!(response.status!==200)){_context5.next=47;break;}_context5.t0=response.status;_context5.next=_context5.t0===400?26:_context5.t0===401?38:_context5.t0===403?41:43;break;case 26:_context5.next=28;return response.text();case 28:responseText=_context5.sent;_responseText$split3=responseText.split(\"|\"),_responseText$split4=_toArray(_responseText$split3),message=_responseText$split4[0],addInfo=_responseText$split4.slice(1);if(Array.isArray(addInfo)&&addInfo[0].length>1){addInfo=JSON.parse(addInfo[0]);}_context5.t1=message;_context5.next=_context5.t1===\"resource_already_linked\"?34:36;break;case 34:toast.error(\"\".concat(addInfo.from,\" has already been linked to lesson \").concat(addInfo.to,\". Please create a new assignment.\"),{toastId:ToastID.set_lesson_duplicate_error.toString()});return _context5.abrupt(\"return\");case 36:toast.error(\"Error: \".concat(responseText),{toastId:ToastID.expired_session.toString(),closeOnClick:true});return _context5.abrupt(\"return\");case 38:toast.error(\"Your session has either expired or been invalidated, please reload the page to try again.\",{toastId:ToastID.expired_session.toString()});this.props.history.push(\"/session-expired\");return _context5.abrupt(\"return\");case 41:toast.error(\"You are not authorized to make this action. (Are you an instructor?)\",{toastId:ToastID.not_authorized.toString()});return _context5.abrupt(\"return\");case 43:toast.error(\"Error setting lesson for assignment \\\"\".concat(this.user.resource_link_title,\".\\\" If reloading does not work, please contact us.\"),{toastId:ToastID.set_lesson_unknown_error.toString()});return _context5.abrupt(\"return\");case 45:_context5.next=53;break;case 47:toast.success(\"Successfully linked assignment \\\"\".concat(this.user.resource_link_title,\"\\\" to lesson \").concat(lesson.id,\" \\\"\").concat(lesson.topics,\"\\\"\"),{toastId:ToastID.set_lesson_success.toString()});_context5.next=50;return response.text();case 50:_responseText=_context5.sent;_responseText$split5=_responseText.split(\"|\"),_responseText$split6=_toArray(_responseText$split5),_message=_responseText$split6[0],_addInfo=_responseText$split6.slice(1);this.props.history.push(\"/assignment-already-linked?to=\".concat(_addInfo.to));case 53:this.lesson=lesson;loadLessonProgress=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var getByKey;return _regeneratorRuntime().wrap(function _callee3$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:getByKey=_this3.context.browserStorage.getByKey;_context4.next=3;return getByKey(LESSON_PROGRESS_STORAGE_KEY(_this3.lesson.id)).catch(function(err){});case 3:return _context4.abrupt(\"return\",_context4.sent);case 4:case\"end\":return _context4.stop();}}},_callee3);}));return function loadLessonProgress(){return _ref5.apply(this,arguments);};}();_context5.next=57;return Promise.all([this.props.loadBktProgress(),loadLessonProgress()]);case 57:_yield$Promise$all=_context5.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);prevCompletedProbs=_yield$Promise$all2[1];if(this._isMounted){_context5.next=63;break;}console.debug(\"component not mounted, returning early (2)\");return _context5.abrupt(\"return\");case 63:if(prevCompletedProbs){console.debug(\"student has already made progress w/ problems in this lesson before\",prevCompletedProbs);this.completedProbs=new Set(prevCompletedProbs);}this.setState({currProblem:this._nextProblem(this.context?this.context:context)},function(){//console.log(this.state.currProblem);\n//console.log(this.lesson);\n});case 65:case\"end\":return _context5.stop();}}},_callee4,this);}));function selectLesson(_x4){return _selectLesson.apply(this,arguments);}return selectLesson;}()},{key:\"render\",value:function render(){var translate=this.props.translate;this.studentNameDisplay=this.context.studentName?decodeURIComponent(this.context.studentName)+\" | \":translate('platform.LoggedIn')+\" | \";return/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:\"#F6F6F6\",paddingBottom:20,display:\"flex\",flexDirection:\"column\"},children:[/*#__PURE__*/_jsx(AppBar,{position:\"static\",children:/*#__PURE__*/_jsx(Toolbar,{children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:0,role:\"navigation\",alignItems:\"center\",children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:3,children:/*#__PURE__*/_jsx(BrandLogoNav,{isPrivileged:this.isPrivileged})},1),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,children:/*#__PURE__*/_jsx(\"div\",{style:{textAlign:\"center\",textAlignVertical:\"center\",paddingTop:\"3px\"},children:Boolean(findLessonById(this.props.lessonID))?findLessonById(this.props.lessonID).name+\" \"+findLessonById(this.props.lessonID).topics:\"\"})},2),/*#__PURE__*/_jsx(Grid,{item:true,xs:3,children:/*#__PURE__*/_jsx(\"div\",{style:{textAlign:\"right\",paddingTop:\"3px\"},children:this.state.status!==\"courseSelection\"&&this.state.status!==\"lessonSelection\"&&(this.lesson.showStuMastery==null||this.lesson.showStuMastery)?this.studentNameDisplay+translate('platform.Mastery')+Math.round(this.state.mastery*100)+\"%\":\"\"})},3)]})})}),this.lesson&&/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"10px 20px\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",fontSize:12},children:[/*#__PURE__*/_jsx(\"span\",{children:\"Progress\"}),/*#__PURE__*/_jsxs(\"span\",{children:[this.getProgressBarData().percent,\"% (\",this.getProgressBarData().completed,\"/\",this.getProgressBarData().total,\")\"]})]}),/*#__PURE__*/_jsx(LinearProgress,{variant:\"determinate\",value:this.getProgressBarData().percent,style:{height:10,borderRadius:5}})]}),this.state.status===\"courseSelection\"?/*#__PURE__*/_jsx(LessonSelectionWrapper,{selectLesson:this.selectLesson,selectCourse:this.selectCourse,history:this.props.history,removeProgress:this.props.removeProgress}):\"\",this.state.status===\"lessonSelection\"?/*#__PURE__*/_jsx(LessonSelectionWrapper,{selectLesson:this.selectLesson,removeProgress:this.props.removeProgress,history:this.props.history,courseNum:this.props.courseNum}):\"\",this.state.status===\"learning\"?/*#__PURE__*/_jsx(ErrorBoundary,{componentName:\"Problem\",descriptor:\"problem\",children:/*#__PURE__*/_jsx(ProblemWrapper,{problem:this.state.currProblem,problemComplete:this.problemComplete,lesson:this.lesson,seed:this.state.seed,lessonID:this.props.lessonID,displayMastery:this.displayMastery,progressPercent:this.getProgressBarData().percent/100})}):\"\",this.state.status===\"exhausted\"?/*#__PURE__*/_jsx(\"center\",{children:/*#__PURE__*/_jsxs(\"h2\",{children:[\"Thank you for learning with \",SITE_NAME,\". You have finished all problems.\"]})}):\"\",this.state.status===\"graduated\"?/*#__PURE__*/_jsx(\"center\",{children:/*#__PURE__*/_jsxs(\"h2\",{children:[\"Thank you for learning with \",SITE_NAME,\". You have mastered all the skills for this session!\"]})}):\"\"]});}}]);return Platform;}(React.Component);Platform.contextType=ThemeContext;export default withRouter(withTranslation(Platform));","map":{"version":3,"names":["React","AppBar","Toolbar","Grid","ProblemWrapper","LessonSelectionWrapper","withRouter","LinearProgress","coursePlans","findLessonById","LESSON_PROGRESS_STORAGE_KEY","MIDDLEWARE_URL","SITE_NAME","ThemeContext","CANVAS_WARNING_STORAGE_KEY","SHOW_NOT_CANVAS_WARNING","MASTERY_THRESHOLD","to","toast","ToastID","BrandLogoNav","cleanArray","ErrorBoundary","CONTENT_SOURCE","withTranslation","problemPool","require","seed","Date","now","toString","console","log","Platform","props","context","selectCourse","course","setState","status","_nextProblem","saveProgress","lesson","topics","completedProbs","has","preambleProblem","problemIndex","problems","find","p","id","currProblem","filter","courseName","startsWith","chosenProblem","debug","slice","problem","probMastery","isRelevant","steps","step","knowledgeComponents","kc","bktParams","learningObjectives","length","size","heuristic","objectives","Object","keys","score","reduce","x","y","displayMastery","some","skill","allowRecycle","Set","firebase","startedProblem","updateCanvas","mastery","components","jwt","fetch","method","headers","body","JSON","stringify","token","err","response","error","toastId","submit_grade_unknown_error","text","responseText","split","message","addInfo","Array","isArray","parse","submit_grade_link_lost","warn","submit_grade_unable","closeOnClick","expired_session","not_authorized","set_lesson_unknown_error","browserStorage","getByKey","setByKey","showWarning","warn_not_from_canvas","autoClose","onClick","dismiss","onClose","problemComplete","add","state","catch","submitSiteLog","errorName","name","errorCode","code","errorMsg","errorStack","stack","relevantKc","forEach","progressData","getProgressBarData","progressPercent","percent","allProblemsCompleted","completed","total","success","successfully_completed_lesson","user","isPrivileged","privileged","stepIndex","skillModel","lessonID","selectLesson","bind","_isMounted","then","_","setLanguage","defaultLocale","localStorage","getItem","courseNum","parseInt","onComponentUpdate","problemID","prevProps","prevState","snapshot","Boolean","lessonName","String","replace","includes","Math","round","updateServer","resource_link_title","from","set_lesson_duplicate_error","history","push","set_lesson_success","loadLessonProgress","Promise","all","loadBktProgress","prevCompletedProbs","translate","studentNameDisplay","studentName","decodeURIComponent","backgroundColor","paddingBottom","display","flexDirection","textAlign","textAlignVertical","paddingTop","showStuMastery","padding","justifyContent","fontSize","height","borderRadius","removeProgress","Component","contextType"],"sources":["/Users/allisonwang/Downloads/chem-final/OATutor-Chem1A/src/platform-logic/Platform.js"],"sourcesContent":["import React from \"react\";\nimport { AppBar, Toolbar } from \"@material-ui/core\";\nimport Grid from \"@material-ui/core/Grid\";\nimport ProblemWrapper from \"@components/problem-layout/ProblemWrapper.js\";\nimport LessonSelectionWrapper from \"@components/problem-layout/LessonSelectionWrapper.js\";\nimport { withRouter } from \"react-router-dom\";\nimport LinearProgress from '@material-ui/core/LinearProgress';\n\nimport {\n    coursePlans,\n    findLessonById,\n    LESSON_PROGRESS_STORAGE_KEY,\n    MIDDLEWARE_URL,\n    SITE_NAME,\n    ThemeContext,\n    CANVAS_WARNING_STORAGE_KEY,\n    SHOW_NOT_CANVAS_WARNING,\n    MASTERY_THRESHOLD,\n} from \"../config/config.js\";\nimport to from \"await-to-js\";\nimport { toast } from \"react-toastify\";\nimport ToastID from \"../util/toastIds\";\nimport BrandLogoNav from \"@components/BrandLogoNav\";\nimport { cleanArray } from \"../util/cleanObject\";\nimport ErrorBoundary from \"@components/ErrorBoundary\";\nimport { CONTENT_SOURCE } from \"@common/global-config\";\nimport withTranslation from '../util/withTranslation';\n\nlet problemPool = require(`@generated/processed-content-pool/${CONTENT_SOURCE}.json`);\n\nlet seed = Date.now().toString();\nconsole.log(\"Generated seed\");\n\nclass Platform extends React.Component {\n    static contextType = ThemeContext;\n\n    constructor(props, context) {\n        super(props);\n        \n        this.problemIndex = {\n            problems: problemPool,\n        };\n        this.completedProbs = new Set();\n        this.lesson = null;\n\n        this.user = context.user || {};\n        console.debug(\"USER: \", this.user)\n        this.isPrivileged = !!this.user.privileged;\n        this.context = context;\n\n        // Add each Q Matrix skill model attribute to each step\n        for (const problem of this.problemIndex.problems) {\n            for (\n                let stepIndex = 0;\n                stepIndex < problem.steps.length;\n                stepIndex++\n            ) {\n                const step = problem.steps[stepIndex];\n                step.knowledgeComponents = cleanArray(\n                    context.skillModel[step.id] || []\n                );\n            }\n        }\n        if (this.props.lessonID == null) {\n            this.state = {\n                currProblem: null,\n                status: \"courseSelection\",\n                seed: seed,\n            };\n        } else {\n            this.state = {\n                currProblem: null,\n                status: \"courseSelection\",\n                seed: seed,\n            };\n        }\n\n        this.selectLesson = this.selectLesson.bind(this);\n    }\n\n    componentDidMount() {\n        this._isMounted = true;\n        if (this.props.lessonID != null) {\n            console.log(\"calling selectLesson from componentDidMount...\") \n            const lesson = findLessonById(this.props.lessonID)\n            console.debug(\"lesson: \", lesson)\n            this.selectLesson(lesson).then(\n                (_) => {\n                    console.debug(\n                        \"loaded lesson \" + this.props.lessonID,\n                        this.lesson\n                    );\n                }\n            );\n\n            const { setLanguage } = this.props;\n            if (lesson.courseName == 'Matematik 4') {\n                setLanguage('se')\n            } else {\n                const defaultLocale = localStorage.getItem('defaultLocale');\n                setLanguage(defaultLocale)\n            }\n        } else if (this.props.courseNum != null) {\n            this.selectCourse(coursePlans[parseInt(this.props.courseNum)]);\n        }\n        this.onComponentUpdate(null, null, null);\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n        this.context.problemID = \"n/a\";\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        this.onComponentUpdate(prevProps, prevState, snapshot);\n    }\n\n    \n    onComponentUpdate(prevProps, prevState, snapshot) {\n        if (\n            Boolean(this.state.currProblem?.id) &&\n            this.context.problemID !== this.state.currProblem.id\n        ) {\n            this.context.problemID = this.state.currProblem.id;\n        }\n        if (this.state.status !== \"learning\") {\n            this.context.problemID = \"n/a\";\n        }\n    }\n\n    getProgressBarData() {\n    if (!this.lesson) return { completed: 0, total: 0, percent: 0 };\n\n    const lessonName = String(this.lesson.name.replace(\"Lesson \", \"\") + \" \" + this.lesson.topics);\n    const problems = this.problemIndex.problems.filter(\n        ({ lesson }) => String(lesson).includes(lessonName)\n    );\n    const completed = this.completedProbs.size;\n    const total = problems.length;\n    const percent = total > 0 ? Math.round((completed / total) * 100) : 0;\n    return { completed, total, percent };\n}\n    \n    async selectLesson(lesson, updateServer=true) {\n        const context = this.context;\n        console.debug(\"lesson: \", context)\n        console.debug(\"update server: \", updateServer)\n        console.debug(\"context: \", context)\n        if (!this._isMounted) {\n            console.debug(\"component not mounted, returning early (1)\");\n            return;\n        }\n        if (this.isPrivileged) {\n            // from canvas or other LTI Consumers\n            console.log(\"valid privilege\")\n            let err, response;\n            [err, response] = await to(\n                fetch(`${MIDDLEWARE_URL}/setLesson`, {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\",\n                    },\n                    body: JSON.stringify({\n                        token: context?.jwt || this.context?.jwt || \"\",\n                        lesson,\n                    }),\n                })\n            );\n            if (err || !response) {\n                toast.error(\n                    `Error setting lesson for assignment \"${this.user.resource_link_title}\"`\n                );\n                console.debug(err, response);\n                return;\n            } else {\n                if (response.status !== 200) {\n                    switch (response.status) {\n                        case 400:\n                            const responseText = await response.text();\n                            let [message, ...addInfo] = responseText.split(\"|\");\n                            if (\n                                Array.isArray(addInfo) &&\n                                addInfo[0].length > 1\n                            ) {\n                                addInfo = JSON.parse(addInfo[0]);\n                            }\n                            switch (message) {\n                                case \"resource_already_linked\":\n                                    toast.error(\n                                        `${addInfo.from} has already been linked to lesson ${addInfo.to}. Please create a new assignment.`,\n                                        {\n                                            toastId:\n                                                ToastID.set_lesson_duplicate_error.toString(),\n                                        }\n                                    );\n                                    return;\n                                default:\n                                    toast.error(`Error: ${responseText}`, {\n                                        toastId:\n                                            ToastID.expired_session.toString(),\n                                        closeOnClick: true,\n                                    });\n                                    return;\n                            }\n                        case 401:\n                            toast.error(\n                                `Your session has either expired or been invalidated, please reload the page to try again.`,\n                                {\n                                    toastId: ToastID.expired_session.toString(),\n                                }\n                            );\n                            this.props.history.push(\"/session-expired\");\n                            return;\n                        case 403:\n                            toast.error(\n                                `You are not authorized to make this action. (Are you an instructor?)`,\n                                {\n                                    toastId: ToastID.not_authorized.toString(),\n                                }\n                            );\n                            return;\n                        default:\n                            toast.error(\n                                `Error setting lesson for assignment \"${this.user.resource_link_title}.\" If reloading does not work, please contact us.`,\n                                {\n                                    toastId:\n                                        ToastID.set_lesson_unknown_error.toString(),\n                                }\n                            );\n                            return;\n                    }\n                } else {\n                    toast.success(\n                        `Successfully linked assignment \"${this.user.resource_link_title}\" to lesson ${lesson.id} \"${lesson.topics}\"`,\n                        {\n                            toastId: ToastID.set_lesson_success.toString(),\n                        }\n                    );\n                    const responseText = await response.text();\n                    let [message, ...addInfo] = responseText.split(\"|\");\n                    this.props.history.push(\n                        `/assignment-already-linked?to=${addInfo.to}`\n                    );\n                }\n            }\n        }\n\n        this.lesson = lesson;\n\n        const loadLessonProgress = async () => {\n            const { getByKey } = this.context.browserStorage;\n            return await getByKey(\n                LESSON_PROGRESS_STORAGE_KEY(this.lesson.id)\n            ).catch((err) => {});\n        };\n\n        const [, prevCompletedProbs] = await Promise.all([\n            this.props.loadBktProgress(),\n            loadLessonProgress(),\n        ]);\n        if (!this._isMounted) {\n            console.debug(\"component not mounted, returning early (2)\");\n            return;\n        }\n        if (prevCompletedProbs) {\n            console.debug(\n                \"student has already made progress w/ problems in this lesson before\",\n                prevCompletedProbs\n            );\n            this.completedProbs = new Set(prevCompletedProbs);\n        }\n        this.setState(\n            {\n                currProblem: this._nextProblem(\n                    this.context ? this.context : context\n                ),\n            },\n            () => {\n                //console.log(this.state.currProblem);\n                //console.log(this.lesson);\n            }\n        );\n    }\n\n    selectCourse = (course, context) => {\n        this.course = course;\n        this.setState({\n            status: \"lessonSelection\",\n        });\n    };\n\n    _nextProblem = (context) => {\n        seed = Date.now().toString();\n        this.setState({ seed: seed });\n        this.props.saveProgress();\n\n        if (this.lesson.topics == \"Atom, Conversion, Stoichiometry (Module A)\" && !this.completedProbs.has(\"a041b61EmailAddress\")) {\n            const preambleProblem = this.problemIndex.problems.find(p => p.id === \"a041b61EmailAddress\");\n            if (preambleProblem) {\n                this.setState({ currProblem: preambleProblem, status: \"learning\" });\n                return preambleProblem;\n            }\n        }\n        \n        const problems = this.problemIndex.problems.filter(\n            ({ courseName }) => !courseName.toString().startsWith(\"!!\")\n        );\n        let chosenProblem;\n\n        console.debug(\n            \"Platform.js: sample of available problems\",\n            problems.slice(0, 10)\n        );\n\n        for (const problem of problems) {\n            // Calculate the mastery for this problem\n            let probMastery = 1;\n            let isRelevant = false;\n            for (const step of problem.steps) {\n                if (typeof step.knowledgeComponents === \"undefined\") {\n                    continue;\n                }\n                for (const kc of step.knowledgeComponents) {\n                    if (typeof context.bktParams[kc] === \"undefined\") {\n                        console.log(\"BKT Parameter \" + kc + \" does not exist.\");\n                        continue;\n                    }\n                    if (kc in this.lesson.learningObjectives) {\n                        isRelevant = true;\n                    }\n                    // Multiply all the mastery priors\n                    if (!(kc in context.bktParams)) {\n                        console.log(\"Missing BKT parameter: \" + kc);\n                    }\n                    probMastery *= context.bktParams[kc].probMastery;\n                }\n            }\n            if (isRelevant) {\n                problem.probMastery = probMastery;\n            } else {\n                problem.probMastery = null;\n            }\n        }\n\n        console.debug(\n            `Platform.js: available problems ${problems.length}, completed problems ${this.completedProbs.size}`\n        );\n        chosenProblem = context.heuristic(problems, this.completedProbs);\n        console.debug(\"Platform.js: chosen problem\", chosenProblem);\n\n        const objectives = Object.keys(this.lesson.learningObjectives);\n        console.debug(\"Platform.js: objectives\", objectives);\n        let score = objectives.reduce((x, y) => {\n            return x + context.bktParams[y].probMastery;\n        }, 0);\n        score /= objectives.length;\n        this.displayMastery(score);\n        //console.log(Object.keys(context.bktParams).map((skill) => (context.bktParams[skill].probMastery <= this.lesson.learningObjectives[skill])));\n\n        // There exists a skill that has not yet been mastered (a True)\n        // Note (number <= null) returns false\n        if (\n            !Object.keys(context.bktParams).some(\n                (skill) =>\n                    context.bktParams[skill].probMastery <= MASTERY_THRESHOLD\n            )\n        ) {\n            this.setState({ status: \"graduated\" });\n            console.log(\"Graduated\");\n            return null;\n        } else if (chosenProblem == null) {\n            console.debug(\"no problems were chosen\");\n            // We have finished all the problems\n            if (this.lesson && !this.lesson.allowRecycle) {\n                // If we do not allow problem recycle then we have exhausted the pool\n                this.setState({ status: \"exhausted\" });\n                return null;\n            } else {\n                this.completedProbs = new Set();\n                chosenProblem = context.heuristic(\n                    problems,\n                    this.completedProbs\n                );\n            }\n        }\n\n        if (chosenProblem) {\n            this.setState({ currProblem: chosenProblem, status: \"learning\" });\n            // console.log(\"Next problem: \", chosenProblem.id);\n            console.debug(\"problem information\", chosenProblem);\n            this.context.firebase.startedProblem(\n                chosenProblem.id,\n                chosenProblem.courseName,\n                chosenProblem.lesson,\n                this.lesson.learningObjectives\n            );\n            return chosenProblem;\n        } else {\n            console.debug(\"still no chosen problem..? must be an error\");\n        }\n    };\n\n        updateCanvas = async (mastery, components) => {\n            if (this.context.jwt) {\n                console.debug(\"updating canvas with problem score\");\n    \n                let err, response;\n                [err, response] = await to(\n                    fetch(`${MIDDLEWARE_URL}/postScore`, {\n                        method: \"POST\",\n                        headers: {\n                            \"Content-Type\": \"application/json\",\n                        },\n                        body: JSON.stringify({\n                            token: this.context?.jwt || \"\",\n                            mastery,\n                            components,\n                        }),\n                    })\n                );\n                \n                if (err || !response) {\n                    toast.error(\n                        `An unknown error occurred trying to submit this problem. If reloading does not work, please contact us.`,\n                        {\n                            toastId: ToastID.submit_grade_unknown_error.toString(),\n                        }\n                    );\n                    console.debug(err, response);\n                } else {\n                    if (response.status !== 200) {\n                        switch (response.status) {\n                            case 400:\n                                const responseText = await response.text();\n                                let [message, ...addInfo] = responseText.split(\"|\");\n                                if (\n                                    Array.isArray(addInfo) &&\n                                    addInfo.length > 0 &&\n                                    addInfo[0]\n                                ) {\n                                    addInfo = JSON.parse(addInfo[0]);\n                                }\n                                switch (message) {\n                                    case \"lost_link_to_lms\":\n                                        toast.error(\n                                            \"It seems like the link back to your LMS has been lost. Please re-open the assignment to make sure your score is saved.\",\n                                            {\n                                                toastId:\n                                                    ToastID.submit_grade_link_lost.toString(),\n                                            }\n                                        );\n                                        return;\n                                    case \"unable_to_handle_score\":\n                                        toast.warn(\n                                            \"Something went wrong and we can't update your score right now. Your progress will be saved locally so you may continue working.\",\n                                            {\n                                                toastId:\n                                                    ToastID.submit_grade_unable.toString(),\n                                                closeOnClick: true,\n                                            }\n                                        );\n                                        return;\n                                    default:\n                                        toast.error(`Error: ${responseText}`, {\n                                            closeOnClick: true,\n                                        });\n                                        return;\n                                }\n                            case 401:\n                                toast.error(\n                                    `Your session has either expired or been invalidated, please reload the page to try again.`,\n                                    {\n                                        toastId: ToastID.expired_session.toString(),\n                                    }\n                                );\n                                return;\n                            case 403:\n                                toast.error(\n                                    `You are not authorized to make this action. (Are you a registered student?)`,\n                                    {\n                                        toastId: ToastID.not_authorized.toString(),\n                                    }\n                                );\n                                return;\n                            default:\n                                toast.error(\n                                    `An unknown error occurred trying to submit this problem. If reloading does not work, please contact us.`,\n                                    {\n                                        toastId:\n                                            ToastID.set_lesson_unknown_error.toString(),\n                                    }\n                                );\n                                return;\n                        }\n                    } else {\n                        console.debug(\"successfully submitted grade to Canvas\");\n                    }\n                }\n            } else {\n                const { getByKey, setByKey } = this.context.browserStorage;\n                const showWarning =\n                    !(await getByKey(CANVAS_WARNING_STORAGE_KEY)) &&\n                    SHOW_NOT_CANVAS_WARNING;\n                if (showWarning) {\n                    toast.warn(\n                        \"No credentials found (did you launch this assignment from Canvas?)\",\n                        {\n                            toastId: ToastID.warn_not_from_canvas.toString(),\n                            autoClose: false,\n                            onClick: () => {\n                                toast.dismiss(\n                                    ToastID.warn_not_from_canvas.toString()\n                                );\n                            },\n                            onClose: () => {\n                                setByKey(CANVAS_WARNING_STORAGE_KEY, 1);\n                            },\n                        }\n                    );\n                } else {\n                    // can ignore\n                }\n            }\n        };\n\n    problemComplete = async (context) => {\n        this.completedProbs.add(this.state.currProblem.id);\n        const { setByKey } = this.context.browserStorage;\n        await setByKey(\n            LESSON_PROGRESS_STORAGE_KEY(this.lesson.id),\n            this.completedProbs\n        ).catch((error) => {\n            this.context.firebase.submitSiteLog(\n                \"site-error\",\n                `componentName: Platform.js`,\n                {\n                    errorName: error.name || \"n/a\",\n                    errorCode: error.code || \"n/a\",\n                    errorMsg: error.message || \"n/a\",\n                    errorStack: error.stack || \"n/a\",\n                },\n                this.state.currProblem.id\n            );\n        });\n        \n        const relevantKc = {};\n        Object.keys(this.lesson.learningObjectives).forEach((x) => {\n            relevantKc[x] = context.bktParams[x]?.probMastery ?? 0;\n        });\n\n        // Check if all problems are completed or all skills are mastered\n        const progressData = this.getProgressBarData();\n        const progressPercent = progressData.percent / 100;\n        const allProblemsCompleted = progressData.completed === progressData.total;\n\n        if (allProblemsCompleted) {\n            console.debug(\"updateCanvas called because lesson is complete\");\n            this.updateCanvas(progressPercent, relevantKc);\n        }\n\n        this._nextProblem(context);\n    };\n\n    displayMastery = (mastery) => {\n        this.setState({ mastery: mastery });\n        if (mastery >= MASTERY_THRESHOLD) {\n            toast.success(\"You've successfully completed this assignment!\", {\n                toastId: ToastID.successfully_completed_lesson.toString(),\n            });\n        }\n    };\n\n    render() {\n        const { translate } = this.props;\n        this.studentNameDisplay = this.context.studentName\n        ? decodeURIComponent(this.context.studentName) + \" | \"\n        : translate('platform.LoggedIn') + \" | \";\n        return (\n            <div\n                style={{\n                    backgroundColor: \"#F6F6F6\",\n                    paddingBottom: 20,\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                }}\n            >\n                <AppBar position=\"static\">\n                    <Toolbar>\n                        <Grid\n                            container\n                            spacing={0}\n                            role={\"navigation\"}\n                            alignItems={\"center\"}\n                        >\n                            <Grid item xs={3} key={1}>\n                                <BrandLogoNav\n                                    isPrivileged={this.isPrivileged}\n                                />\n                            </Grid>\n                            <Grid item xs={6} key={2}>\n                                <div\n                                    style={{\n                                        textAlign: \"center\",\n                                        textAlignVertical: \"center\",\n                                        paddingTop: \"3px\",\n                                    }}\n                                >\n                                    {Boolean(\n                                        findLessonById(this.props.lessonID)\n                                    )\n                                        ? findLessonById(this.props.lessonID)\n                                              .name +\n                                          \" \" +\n                                          findLessonById(this.props.lessonID)\n                                              .topics\n                                        : \"\"}\n                                </div>\n                            </Grid>\n                            <Grid item xs={3} key={3}>\n                                <div\n                                    style={{\n                                        textAlign: \"right\",\n                                        paddingTop: \"3px\",\n                                    }}\n                                >\n                                    {this.state.status !== \"courseSelection\" &&\n                                    this.state.status !== \"lessonSelection\" &&\n                                    (this.lesson.showStuMastery == null ||\n                                        this.lesson.showStuMastery)\n                                        ? this.studentNameDisplay +\n                                        translate('platform.Mastery') +\n                                          Math.round(this.state.mastery * 100) +\n                                          \"%\"\n                                        : \"\"}\n                                </div>\n                            </Grid>\n                        </Grid>\n                    </Toolbar>\n                </AppBar>\n                {/* Progress Bar */}\n{this.lesson && (\n    <div style={{ padding: \"10px 20px\" }}>\n        <div style={{ display: \"flex\", justifyContent: \"space-between\", fontSize: 12 }}>\n            <span>Progress</span>\n            <span>{this.getProgressBarData().percent}% ({this.getProgressBarData().completed}/{this.getProgressBarData().total})</span>\n        </div>\n        <LinearProgress\n            variant=\"determinate\"\n            value={this.getProgressBarData().percent}\n            style={{ height: 10, borderRadius: 5 }}\n        />\n    </div>\n)}\n                {this.state.status === \"courseSelection\" ? (\n                    <LessonSelectionWrapper\n                        selectLesson={this.selectLesson}\n                        selectCourse={this.selectCourse}\n                        history={this.props.history}\n                        removeProgress={this.props.removeProgress}\n                    />\n                ) : (\n                    \"\"\n                )}\n                {this.state.status === \"lessonSelection\" ? (\n                    <LessonSelectionWrapper\n                        selectLesson={this.selectLesson}\n                        removeProgress={this.props.removeProgress}\n                        history={this.props.history}\n                        courseNum={this.props.courseNum}\n                    />\n                ) : (\n                    \"\"\n                )}\n                {this.state.status === \"learning\" ? (\n                    <ErrorBoundary\n                        componentName={\"Problem\"}\n                        descriptor={\"problem\"}\n                    >\n                        <ProblemWrapper\n                            problem={this.state.currProblem}\n                            problemComplete={this.problemComplete}\n                            lesson={this.lesson}\n                            seed={this.state.seed}\n                            lessonID={this.props.lessonID}\n                            displayMastery={this.displayMastery}\n                            progressPercent={this.getProgressBarData().percent / 100}\n                        />\n                    </ErrorBoundary>\n                ) : (\n                    \"\"\n                )}\n                {this.state.status === \"exhausted\" ? (\n                    <center>\n                        <h2>\n                            Thank you for learning with {SITE_NAME}. You have\n                            finished all problems.\n                        </h2>\n                    </center>\n                ) : (\n                    \"\"\n                )}\n                {this.state.status === \"graduated\" ? (\n                    <center>\n                        <h2>\n                            Thank you for learning with {SITE_NAME}. You have\n                            mastered all the skills for this session!\n                        </h2>\n                    </center>\n                ) : (\n                    \"\"\n                )}\n            </div>\n        );\n    }\n}\n\nexport default withRouter(withTranslation(Platform));\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}